<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Node.js and HTML</title>
  <!-- Add Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Add Prompt font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap">
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <!-- Include Axios library -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <!-- Add this in your <head> section -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

</head>
<style>
  body {
    font-family: 'Prompt', sans-serif;
  }

  .container {
    max-width: 800px;
  }
</style>

<body class="bg-light">
  <div class="container mt-5">
    <h1 class="display-4 text-center"></h1>
    <div class="mb-3">
      <label for="urlInput" class="form-label">ลิงค์ที่ต้องการดึงข้อมูล:</label>
      <div class="input-group">
        <input type="text" class="form-control" id="urlInput" placeholder="https://example.com"
          value="https://www.feasyonline.com/myproperty/project/summary?pid=100764&token=f3c98637-ffd1-4a86-a12b-1b8f0683c80e">
        <button class="btn btn-primary" id="runNode">ดึงข้อมูล</button>
      </div>
    </div>

    <div id="output" class="mt-4"></div>

    <!-- Loading indicator -->
    <div id="loadingIndicator" class="text-center mt-3" style="display: none;">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">กำลังดึงข้อมูล โปรดอย่ารีเฟรช</span>
      </div>
      <p>กำลังดึงข้อมูล โปรดอย่ารีเฟรช</p>
    </div>
  </div>

  <form id="formtosalesforce">
    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">หัวข้อประกาศ</h5>
          <div class="mb-3">
            <label for="title" class="form-label">หัวข้อ</label>
            <input type="text" class="form-control" id="title" placeholder="">
          </div>
          <div class="mb-3">
            <label for="titleEng" class="form-label">หัวข้อ English</label>
            <input type="text" class="form-control" id="titleEng" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">ตำบล/แขวง</h5>
          <div class="mb-3">
            <label for="subdistrict" class="form-label">ตำบล</label>
            <input type="text" class="form-control" id="subdistrict" placeholder="">
          </div>
          <div class="mb-3">
            <label for="subdistrictEng" class="form-label">ตำบล English</label>
            <input type="text" class="form-control" id="subdistrictEng" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">อำเภอ/เขต</h5>
          <div class="mb-3">
            <label for="district" class="form-label">อำเภอ</label>
            <input type="text" class="form-control" id="district" placeholder="">
          </div>
          <div class="mb-3">
            <label for="districtEng" class="form-label">อำเภอ English</label>
            <input type="text" class="form-control" id="districtEng" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">จังหวัด</h5>
          <div class="mb-3">
            <label for="province" class="form-label">จังหวัด</label>
            <input type="text" class="form-control" id="province" placeholder="">
            <div class="mb-3">
              <label for="provinceEng" class="form-label">จังหวัด English</label>
              <input type="text" class="form-control" id="provinceEng" placeholder="">
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">พิกัด</h5>
          <div class="mb-3">
            <label for="mapLink" class="form-label">Map link</label>
            <input type="text" class="form-control" id="mapLink" placeholder="">
          </div>
          <div class="mb-3">
            <label for="latitude" class="form-label">latitude:</label>
            <input type="text" class="form-control" id="latitude" placeholder="">
          </div>

          <div class="mb-3">
            <label for="longitude" class="form-label">longitude:</label>
            <input type="text" class="form-control" id="longitude" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">ขนาดที่ดิน</h5>
          <div class="mb-3">
            <label for="rai" class="form-label">ไร่:</label>
            <input type="text" class="form-control" id="rai" placeholder="">
          </div>

          <div class="mb-3">
            <label for="ngan" class="form-label">งาน:</label>
            <input type="text" class="form-control" id="ngan" placeholder="">
          </div>

          <div class="mb-3">
            <label for="squareWah" class="form-label">ตารางวา:</label>
            <input type="text" class="form-control" id="squareWah" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">ราคาขาย</h5>
          <div class="mb-3">
            <label for="price" class="form-label">ราคา:</label>
            <input type="text" class="form-control" id="price" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">ผังเมืองปัจจุบัน</h5>
          <div class="mb-3">
            <label for="cityPlan" class="form-label">ผังเมือง:</label>
            <input type="text" class="form-control" id="cityPlan" placeholder="">
          </div>
          <div class="mb-3">
            <label for="cityPlanEng" class="form-label">ผังเมือง Eng:</label>
            <input type="text" class="form-control" id="cityPlanEng" placeholder="">
          </div>

          <div class="mb-3">
            <label for="yor" class="form-label">ย. (พื้นที่ หรือ หมายเลข):</label>
            <input type="text" class="form-control" id="yor" placeholder="">
          </div>
          <div class="mb-3">
            <label for="yorEng" class="form-label">ย. English:</label>
            <input type="text" class="form-control" id="yorEng" placeholder="">
          </div>

          <div class="mb-3">
            <label for="far" class="form-label">FAR :</label>
            <input type="text" class="form-control" id="far" placeholder="">
          </div>

          <div class="mb-3">
            <label for="cityPlanProvince" class="form-label">ผังเมืองจังหวัด :</label>
            <input type="text" class="form-control" id="cityPlanProvince" placeholder="">
          </div>

          <div class="mb-3">
            <label for="cityPlanProvinceEng" class="form-label">ผังเมืองจังหวัด English:</label>
            <input type="text" class="form-control" id="cityPlanProvinceEng" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">ผังเมืองอนาคต</h5>
          <div class="mb-3">
            <label for="futureCityPlan" class="form-label">ผังเมืองอนาคต:</label>
            <input type="text" class="form-control" id="futureCityPlan" placeholder="">
          </div>
          <div class="mb-3">
            <label for="futureCityPlanEng" class="form-label">ผังเมืองอนาคต English:</label>
            <input type="textEng" class="form-control" id="futureCityPlanEng" placeholder="">
          </div>
          <div class="mb-3">
            <label for="yorfutureCityPlan" class="form-label">ย. อนาคต:</label>
            <input type="text" class="form-control" id="yorfutureCityPlan" placeholder="">
          </div>
          <div class="mb-3">
            <label for="yorfutureCityPlanEng" class="form-label">ย. อนาคต English:</label>
            <input type="text" class="form-control" id="yorfutureCityPlanEng" placeholder="">
          </div>
          <div class="mb-3">
            <label for="faryorfutureCityPlan" class="form-label">FAR. อนาคต :</label>
            <input type="text" class="form-control" id="faryorfutureCityPlan" placeholder="">
          </div>

          <div class="mb-3">
            <label for="cityPlanProvincefuture" class="form-label">ผังเมืองจังหวัดอนาคต :</label>
            <input type="text" class="form-control" id="cityPlanProvincefuture" placeholder="">
          </div>

          <div class="mb-3">
            <label for="cityPlanProvincefutureEng" class="form-label">ผังเมืองจังหวัดอนาคต English:</label>
            <input type="text" class="form-control" id="cityPlanProvincefutureEng" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">หน้ากว้าง ความลึก</h5>
          <div class="mb-3">
            <label for="width" class="form-label">หน้ากว้าง:</label>
            <input type="text" class="form-control" id="width" placeholder="">
          </div>
          <div class="mb-3">
            <label for="landDepth" class="form-label"><span style="color: red;">ความลึกที่ดิน
                (ต้องกรอกด้วยตนเอง)</span></label>
            <input type="number" class="form-control" id="landDepth" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">ความกว้าถนนหน้าที่ดิน</h5>
          <div class="mb-3">
            <label for="roadWidth" class="form-label">ถนนหน้าที่ดินกว้าง:</label>
            <input type="text" class="form-control" id="roadWidth" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">พื้นที่ห้ามก่อสร้าง</h5>
          <div class="mb-3">
            <label for="noConstruction" class="form-label">ห้ามก่อสร้าง:</label>
            <input type="text" class="form-control" id="noConstruction" placeholder="">
          </div>
          <div class="mb-3">
            <label for="noConstructionEng" class="form-label">ห้ามก่อสร้าง English</label>
            <input type="text" class="form-control" id="noConstructionEng" placeholder="">
          </div>

        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">สถานที่ใกล่เคียง</h5>
          <div class="mb-3">
            <label for="nearby" class="form-label">สถานที่ใกล้เคียง :</label>
            <small id="noConstructionHelp" class="form-text text-muted">
              <textarea id="nearby" class="form-control" placeholder="ระบุสถานที่" rows="10"></textarea>
            </small>
          </div>
          <div class="mb-3">
            <label for="nearbyEng" class="form-label">สถานที่ใกล้เคียง English</label>
            <small id="noConstructionHelp" class="form-text text-muted">
              <textarea id="nearbyEng" class="form-control" placeholder="ระบุสถานที่" rows="10"></textarea>
            </small>
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">รายละเอียด</h5>
          <div class="mb-3">
            <label for="nearby" class="form-label">รายละเอียดเพิ่มเติม :</label>
            <div id="descriptionThai" style="height: 300px;"></div>
          </div>
          <div class="mb-3">
            <label for="nearby" class="form-label">รายละเอียดเพิ่มเติม :</label>
            <div id="descriptionEng" style="height: 300px;"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <h2><span style="color: red;">ส่วนต่อจากคุณคุณต้องกรอกข้อมูลเอง เพื่อให้ข้อมูลสมบูรณ์</span> </h2>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">ระดับความน่าเชื่อถือของข้อมูล %</span></h5>
          <div class="mb-3">
            <label for="Level_of_reliability_of_information" class="form-label"><span
                style="color: red;">ระดับความน่าเชื่อถือของข้อมูล %</span></label>
            <input type="number" class="form-control" id="Level_of_reliability_of_information" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">ราคาประเมินแปลงสูงสุด ต่อตารางวา</span></h5>
          <div class="mb-3">
            <label for="appraisalPrice" class="form-label"><span style="color: red;">ราคาประเมินแปลงสูงสุด
                ต่อตารางวา</span></label>
            <input type="number" class="form-control" id="appraisalPrice" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">จำนวนโฉนด</span></h5>
          <div class="mb-3">
            <label for="totaltitleDeed" class="form-label"><span style="color: red;">จำนวนโฉนด</span></label>
            <input type="number" class="form-control" id="totaltitleDeed" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">ชื่อถนน</span></h5>
          <div class="mb-3">
            <label for="roadName" class="form-label"><span style="color: red;">ชื่อถนน</span></label>
            <input type="text" class="form-control" id="roadName" placeholder="">
          </div>

          <div class="mb-3">
            <label for="roadNameEng" class="form-label"><span style="color: red;">ชื่อถนน English</span></label>
            <input type="text" class="form-control" id="roadNameEng" placeholder="">
          </div>
        </div>
      </div>
    </div>


    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">สถานะถนน</span></h5>
          <div class="mb-3">
            <label for="roadStatus" class="form-label"><span style="color: red;">สถานะถนน</span> :</label>
            <select class="form-select" id="roadStatus" onchange="updateRoadStatus()">
              <option value="-">-</option>
              <option value="ถนนสาธารณะประโยชน์">ถนนสาธารณะประโยชน์</option>
              <option value="ถนนสาธารณะประโยชน์ตลอดแนว">ถนนสาธารณะประโยชน์ตลอดแนว</option>
              <option value="ทางสาธารณะประโยชน์">ทางสาธารณะประโยชน์</option>
              <option value="ทางสาธารณะประโยชน์ตลอดแนว">ทางสาธารณะประโยชน์ตลอดแนว</option>
              <option value="ทางเป็นเลขที่ดิน">ทางเป็นเลขที่ดิน</option>
              <option value="ทางเป็นเลขที่ดินตลอดแนว">ทางเป็นเลขที่ดินตลอดแนว</option>
              <option value="ทางเป็นเลขที่ดินตลอดแนว">ทางเป็นเลขที่ดินตลอดแนว</option>
              <option value="เลขที่ดินตลอดแนว">เลขที่ดินตลอดแนว</option>
              <option value="ทางภาระจำยอม">ทางภาระจำยอม</option>
              <option value="รอตรวจสอบ">รอตรวจสอบ</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="roadStatusEng" class="form-label"><span style="color: red;">สถานะถนน Eng</span></label>
            <input type="text" class="form-control" id="roadStatusEng" placeholder="">
          </div>
        </div>
      </div>
    </div>


    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">ชื่อซอย</span></h5>
          <div class="mb-3">
            <label for="soiName" class="form-label"><span style="color: red;">ชื่อซอย</span></label>
            <input type="text" class="form-control" id="soiName" placeholder="">
          </div>
          <div class="mb-3">
            <label for="soiNameEng" class="form-label"><span style="color: red;">ชื่อซอย</span></label>
            <input type="text" class="form-control" id="soiNameEng" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">ค่าใช้จ่ายโอนกรรมสิทธิ์</span></h5>
          <div class="mb-3">
            <label for="tranfer" class="form-label"><span style="color: red;">ค่าใช้จ่ายโอนกรรมสิทธิ์</span></label>
            <input type="text" class="form-control" id="tranfer" placeholder="">
          </div>

          <div class="mb-3">
            <label for="tranferEng" class="form-label"><span style="color: red;">ค่าใช้จ่ายโอนกรรมสิทธิ์
                English</span></label>
            <input type="text" class="form-control" id="tranferEng" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">สภาพที่ดิน</span></h5>
          <div class="mb-3">
            <label for="Land_and_building_conditions" class="form-label"><span
                style="color: red;">สภาพที่ดิน</span></label>
            <select class="form-select" id="Land_and_building_conditions" onchange="updateLandCondition()">
              <option value="-">-</option>
              <option value="ถมแล้วระดับถนน ไม่มีสิ่งปลูกสร้าง">ถมแล้วระดับถนน ไม่มีสิ่งปลูกสร้าง</option>
              <option value="ถมแล้วระดับถนน มีสิ่งปลูกสร้าง">ถมแล้วระดับถนน มีสิ่งปลูกสร้าง</option>
              <option value="ยังไม่ถม ต่ำกว่าระดับถนน ไม่มีสิ่งปลูกสร้าง">ยังไม่ถม ต่ำกว่าระดับถนน ไม่มีสิ่งปลูกสร้าง
              </option>
              <option value="ยังไม่ถม ต่ำกว่าระดับถนน มีสิ่งปลูกสร้าง">ยังไม่ถม ต่ำกว่าระดับถนน มีสิ่งปลูกสร้าง</option>
              <option value="ยังไม่ถมต่ำกว่าระดับถนน ลักษณะคล้ายป่าชายเลน">ยังไม่ถมต่ำกว่าระดับถนน ลักษณะคล้ายป่าชายเลน
              </option>
              <option value="ยังไม่ถมต่ำว่าระดับถนน เป็นบ่อ รอวัดความลึก">ยังไม่ถมต่ำว่าระดับถนน เป็นบ่อ รอวัดความลึก
              </option>
            </select>
          </div>

          <div class="mb-3">
            <label for="Land_and_building_conditionsEng" class="form-label"><span style="color: red;">สภาพที่ดิน
                English</span></label>
            <input type="text" class="form-control" id="Land_and_building_conditionsEng" placeholder="">
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">สัญญาเช่าในที่ดิน</span></h5>
          <div class="mb-3">
            <label for="tenant" class="form-label">สัญญาเช่าในที่ดิน :</label>
            <select class="form-select" id="tenant" onchange="updateTenantEng()">
              <option value="">-</option>
              <option value="รอตรวจสอบ">รอตรวจสอบ</option>
              <option value="มีสัญญาเช่าในที่ดิน">มีสัญญาเช่าในที่ดิน</option>
              <option value="ไม่มี">ไม่มี</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="tenantEng" class="form-label">สัญญาเช่าในที่ดิน : Eng :</label>
            <input type="text" class="form-control" id="tenantEng" placeholder="">
          </div>
        </div>
      </div>
    </div>


    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">ประเภทเร็คคอร์ด Salesforce *</span></h5>
          <div class="mb-3">
            <label for="listing_type" class="form-label"><span style="color: red;">ประเภทเร็คคอร์ด
                Salesforce</span></label>
            <select class="form-select" id="listing_type">
              <option value="">-</option>
              <option value="0125w00000161U6AAI">Sale</option>
              <option value="0125w00000161U7AAI">Rent</option>
              <option value="0125w000000hwlnAAA">Land Sale</option>
              <option value="0125w000000hwb3AAA">Land Rent</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">ประเภทอสังหา *</span></h5>
          <div class="mb-3">
            <label for="PropertyType" class="form-label">ประเภททรัพย์ :</label>
            <select class="form-select" id="PropertyType">
              <option value="">-</option>
              <option value="Apartment">Apartment</option>
              <option value="Commercial Building">Commercial Building</option>
              <option value="Condo">Condo</option>
              <option value="Factory">Factory</option>
              <option value="Hotel">Hotel</option>
              <option value="House">House</option>
              <option value="Land">Land</option>
              <option value="Office">Office</option>
              <option value="Office Building">Office Building</option>
              <option value="Other">Other</option>
              <option value="Resort">Resort</option>
              <option value="Townhome">Townhome</option>
              <option value="Townhouse">Townhouse</option>
              <option value="Warehouse">Warehouse</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title"><span style="color: red;">นำเข้าบัญชีเอเจนท์คนไหน *</span></h5>
          <div class="mb-3">
            <label for="agent" class="form-label">เอเจนท์ :</label>
            <select class="form-select" id="agent" required>
              <option value="">-</option>
              <option value="0055w00000CEiMYAA1">หน่อย</option>
              <option value="0055w00000CEiMXAA1">พรีม</option>
              <option value="0055w00000CEiI5AAL">อนันต์</option>
              <option value="0055w00000CEjCZAA1">สกาย</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title text-danger">โปรดตรวจสอบก่อนมูลก่อนนำเข้า</h5>
          <!-- Disable the submit button during the request -->
<input type="submit" class="btn btn-success" id="sendToSalesforce" value="ส่งไปยัง Salesforce" onclick="sendToSalesforce()">
          <!-- Add a loading spinner -->
<div class="spinner-border text-primary" role="status" id="loadingSpinner" style="display: none;">
  <span class="visually-hidden">Loading...</span>
</div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title text-danger">สถานะการนำเข้าข้อมูล</h5>        
          <div id="response-message"></div>
        </div>
      </div>
    </div>

  </form>
  <!-- Add Bootstrap JS and Popper.js -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

  <script>
    // Translate
async function translateText(text, targetElementId) {
  const urlTranslate = 'https://translate.googleapis.com/translate_a/single';
  const params = {
    client: 'gtx',
    sl: 'th',
    tl: 'en',
    dt: 't',
    q: text,
    ie: 'UTF-8',
    oe: 'UTF-8',
  };

  try {
    const response = await axios.get(urlTranslate, { params });
    if (response.data && response.data[0] && response.data[0][0]) {
      document.getElementById(targetElementId).value = response.data[0][0][0];
    } else {
      throw new Error('Unexpected response structure');
    }
  } catch (error) {
    console.error(`Translation error: ${error.message}`);
  }
}

// translate input
document.getElementById('roadName').addEventListener('input', async function () {
  const roadName = this.value;
  await translateText(roadName, 'roadNameEng');
});

document.getElementById('soiName').addEventListener('input', async function () {
  const soiName = this.value;
  await translateText(soiName, 'soiNameEng');
});

document.getElementById('tranfer').addEventListener('input', async function () {
  const tranfer = this.value;
  await translateText(tranfer, 'tranferEng');
});

document.getElementById('title').addEventListener('input', async function () {
  const title = this.value;
  await translateText(title, 'titleEng');
});

document.getElementById('subdistrict').addEventListener('input', async function () {
  const subdistrict = this.value;
  await translateText(subdistrict, 'subdistrictEng');
});

document.getElementById('district').addEventListener('input', async function () {
  const district = this.value;
  await translateText(district, 'districtEng');
});

document.getElementById('province').addEventListener('input', async function () {
  const province = this.value;
  await translateText(province, 'provinceEng');
});

document.getElementById('cityPlan').addEventListener('input', async function () {
  const cityPlan = this.value;
  await translateText(cityPlan, 'cityPlanEng');
});

document.getElementById('cityPlanProvince').addEventListener('input', async function () {
  const cityPlanProvince = this.value;
  await translateText(cityPlanProvince, 'cityPlanProvinceEng');
});

document.getElementById('futureCityPlan').addEventListener('input', async function () {
  const futureCityPlan = this.value;
  await translateText(futureCityPlan, 'futureCityPlanEng');
});


document.getElementById('cityPlanProvincefuture').addEventListener('input', async function () {
  const cityPlanProvincefuture = this.value;
  await translateText(cityPlanProvincefuture, 'cityPlanProvincefutureEng');
});

document.getElementById('noConstruction').addEventListener('input', async function () {
  const noConstruction = this.value;
  await translateText(noConstruction, 'noConstructionEng');
});

// End Transalte


//Road Update 
function updateRoadStatus() {
  var selectElement = document.getElementById("roadStatus");
  var inputValueElement = document.getElementById("roadStatusEng");

  var selectedValue = selectElement.value;
  var roadStatusEng = "";

  switch (selectedValue) {
    case "-":
      roadStatusEng = "";
      break;
    case "ถนนสาธารณะประโยชน์":
      roadStatusEng = "Public Road";
      break;
    case "ถนนสาธารณะประโยชน์ตลอดแนว":
      roadStatusEng = "Public Road";
      break;
    case "ทางสาธารณะประโยชน์":
      roadStatusEng = "Public Road";
      break;
    case "ทางสาธารณะประโยชน์ตลอดแนว":
      roadStatusEng = "Public Road";
      break;
    case "ทางเป็นเลขที่ดิน":
      roadStatusEng = "Private Road";
      break;
    case "ทางเป็นเลขที่ดินตลอดแนว":
      roadStatusEng = "Private Road";
      break;
    case "เลขที่ดินตลอดแนว":
      roadStatusEng = "Private Road";
      break;
    case "ทางภาระจำยอม":
      roadStatusEng = "Servitude Raod";
      break;
    case "รอตรวจสอบ":
      roadStatusEng = "Wait For Confirmation";
      break;
    default:
      roadStatusEng = "";
      break;
  }

  inputValueElement.value = roadStatusEng;
}
//End Road Update 

//สำหรับอัปเดตค่า Land_and_building_conditionsEng
function updateLandCondition() {
  var selectElement = document.getElementById("Land_and_building_conditions");
  var inputValueElement = document.getElementById("Land_and_building_conditionsEng");

  var selectedValue = selectElement.value;
  var landConditionEng = "";

  switch (selectedValue) {
    case "ถมแล้วระดับถนน ไม่มีสิ่งปลูกสร้าง":
      landConditionEng = "Vacant Land";
      break;
    case "ถมแล้วระดับถนน มีสิ่งปลูกสร้าง":
      landConditionEng = "Land With Building";
      break;
    case "ยังไม่ถม ต่ำกว่าระดับถนน ไม่มีสิ่งปลูกสร้าง":
      landConditionEng = "Vacant Land";
      break;
    case "ยังไม่ถม ต่ำกว่าระดับถนน มีสิ่งปลูกสร้าง":
      landConditionEng = "Land With Building";
      break;
    case "ยังไม่ถมต่ำกว่าระดับถนน ลักษณะคล้ายป่าชายเลน":
      landConditionEng = "Vacant Land";
      break;
    case "ยังไม่ถมต่ำว่าระดับถนน เป็นบ่อ รอวัดความลึก":
      landConditionEng = "Vacant Land";
      break;
    default:
      landConditionEng = "";
      break;
  }

  inputValueElement.value = landConditionEng;
}
//End สำหรับอัปเดตค่า Land_and_building_conditionsEng


//อัปเดต สัญญาเช่าในที่ดิน
function updateTenantEng() {
  var tenantDropdown = document.getElementById("tenant");
  var tenantEngInput = document.getElementById("tenantEng");

  switch (tenantDropdown.value) {
    case "รอตรวจสอบ":
      tenantEngInput.value = "Wait For Confirmation";
      break;
    case "มีสัญญาเช่าในที่ดิน":
      tenantEngInput.value = "Land lease agreement";
      break;
    case "ไม่มี":
      tenantEngInput.value = "Not attached to the land lease contract";
      break;
    default:
      tenantEngInput.value = "";
      break;
  }
}
//End อัปเดต สัญญาเช่าในที่ดิน

//Quill Text List
var quill1 = new Quill('#descriptionThai', {
  theme: 'snow'
});
var htmlContent = quill1.root.innerHTML;
console.log(htmlContent);

var quill2 = new Quill('#descriptionEng', {
  theme: 'snow'
});
var htmlContent = quill2.root.innerHTML;
console.log(htmlContent);
//Quill


//runnode Click
document.getElementById('runNode').addEventListener('click', async () => {
  // Reset the output and loading indicator
  document.getElementById('output').innerText = '';
  document.getElementById('loadingIndicator').style.display = 'block';

  try {
    // Get the URL value from the input
    const inputUrl = document.getElementById('urlInput').value;
    // Send the URL value to the server
    const response = await fetch(`/runNode?url=${encodeURIComponent(inputUrl)}`);
    const data = await response.json();
    // Display the result from the received Node.js code
    document.getElementById('output').innerText = data.message;
    document.getElementById('title').value = data.title.substring(0, 80);
    document.getElementById('titleEng').value = data.titleEng.substring(0, 70);
    document.getElementById('subdistrict').value = data.subdistrict;
    document.getElementById('subdistrictEng').value = data.subdistrictEng;
    document.getElementById('district').value = data.district;
    document.getElementById('districtEng').value = data.districtEng;
    document.getElementById('province').value = data.province;
    document.getElementById('provinceEng').value = data.provinceEng;
    document.getElementById('mapLink').value = data.mapLink;
    document.getElementById('latitude').value = data.latitude;
    document.getElementById('longitude').value = data.longitude;
    document.getElementById('rai').value = data.rai;
    document.getElementById('ngan').value = data.ngan;
    document.getElementById('squareWah').value = data.squareWah;
    document.getElementById('price').value = data.price;
    document.getElementById('cityPlan').value = data.cityPlan;
    document.getElementById('cityPlanEng').value = data.cityPlanEng;
    document.getElementById('yor').value = data.yor;
    document.getElementById('yorEng').value = data.yorEng;
    document.getElementById('far').value = data.far;
    document.getElementById('cityPlanProvince').value = data.cityPlanProvince;
    document.getElementById('cityPlanProvinceEng').value = data.cityPlanProvinceEng;
    document.getElementById('futureCityPlan').value = data.futureCityPlan;
    document.getElementById('futureCityPlanEng').value = data.futureCityPlanEng;
    document.getElementById('yorfutureCityPlan').value = data.yorfutureCityPlan;
    document.getElementById('yorfutureCityPlanEng').value = data.yorfutureCityPlanEng;
    document.getElementById('faryorfutureCityPlan').value = data.faryorfutureCityPlan;
    document.getElementById('cityPlanProvincefuture').value = data.cityPlanProvincefuture;
    document.getElementById('cityPlanProvincefutureEng').value = data.cityPlanProvincefutureEng;
    document.getElementById('width').value = data.width;
    document.getElementById('roadWidth').value = data.roadWidth;
    document.getElementById('noConstruction').value = data.noConstruction;
    document.getElementById('noConstructionEng').value = data.noConstructionEng;
    document.getElementById('nearby').value = data.nearby.replace(/<li>/g, '');
    document.getElementById('nearbyEng').value = data.nearbyEng.replace(/<li>/g, '');
    document.getElementById('descriptionThai').innerHTML = data.descriptionThai;
    document.getElementById('descriptionEng').innerHTML = data.descriptionEng;
  } catch (error) {
    // Handle errors here, for example, display an error message
    console.error('Error during fetching:', error);
    document.getElementById('output').innerText = 'An error occurred during scraping.';
  } finally {
    // Hide loading indicator, whether the request was successful or not
    document.getElementById('loadingIndicator').style.display = 'none';
  }
});


function validateForm() {
  var propertyType = document.getElementById('PropertyType').value;
  var agent = document.getElementById('agent').value;
  var listing_type = document.getElementById('listing_type').value;

  if (listing_type === '') {
    alert('โปรดเลือก ประเภทเร็คคอร์ด Salesforce');
    return false;
  }
  if (propertyType === '') {
    alert('โปรดเลือก ประเภทอสังหาฯ');
    return false;
  }

  if (agent === '') {
    alert('โปรดเลือก เอเจนท์');
    return false;
  }

  return true; // Form is valid
}


//data Send to Salesforce
document.getElementById('sendToSalesforce').addEventListener('click', async (event) => {
  event.preventDefault(); // Prevent the default form submission behavior
  if (validateForm()) {

    var descriptionThaiContent = document.getElementById('descriptionThai').innerHTML;
    var descriptionEngContent = document.getElementById('descriptionEng').innerHTML;

    // ดึงค่า roadWidth จากอิลิเมนต์ที่มี ID เป็น 'roadWidth'
    const roadWidthInput = document.getElementById('roadWidth');
    const roadWidthValue = parseFloat(roadWidthInput.value);
    let roadWidthConvert;

    if (roadWidthInput.value === "") {
      roadWidthConvert = "";
    } else if (roadWidthValue <= 6) {
      roadWidthConvert = roadWidthValue;
    } else if (roadWidthValue <= 10) {
      roadWidthConvert = ">6";
    } else if (roadWidthValue <= 20) {
      roadWidthConvert = ">10";
    } else if (roadWidthValue <= 30) {
      roadWidthConvert = ">20";
    } else if (roadWidthValue <= 40) {
      roadWidthConvert = ">30";
    } else if (roadWidthValue <= 50) {
      roadWidthConvert = ">40";
    } else if (roadWidthValue <= 80) {
      roadWidthConvert = ">50";
    } else if (roadWidthValue <= 100) {
      roadWidthConvert = ">80";
    } else if (roadWidthValue <= 200) {
      roadWidthConvert = ">100";
    } else if (roadWidthValue <= 300) {
      roadWidthConvert = ">200";
    } else if (roadWidthValue <= 400) {
      roadWidthConvert = ">300";
    } else if (roadWidthValue <= 500) {
      roadWidthConvert = ">400";
    } else if (roadWidthValue <= 1000) {
      roadWidthConvert = ">500";
    } else {
      roadWidthConvert = ">1000";
    }

    /// เช็คค่าว่างผังเมือง
    var convertCityPlan = "";
    var cityPlanValue = document.getElementById('cityPlan').value;
    var yorValue = document.getElementById('yor').value;
    var farValue = document.getElementById('far').value;

    // ตรวจสอบว่าทั้ง 3 ตัวแปรมีค่าว่างหรือไม่
    if (cityPlanValue === "" && yorValue === "" && farValue === "") {
      convertCityPlan = ""; // ถ้าทั้ง 3 ตัวแปรเป็นค่าว่าง
    } else {
      convertCityPlan = ""; // ตั้งค่าเริ่มต้นเป็นว่าง

      // ตรวจสอบแต่ละตัวแปร
      if (cityPlanValue !== "") {
        convertCityPlan += cityPlanValue;
      }
      if (yorValue !== "") {
        if (convertCityPlan !== "") {
          convertCityPlan += ' ';
        }
        convertCityPlan += yorValue;
      }
      if (farValue !== "") {
        if (convertCityPlan !== "") {
          convertCityPlan += ' FAR ' + farValue + ' : 1 ';
        }
      }
    }

    // เช็คค่าว่างผังเมือง Eng
    var cityPlanEngValue = document.getElementById('cityPlanEng').value;
    var yorEngValue = document.getElementById('yorEng').value;
    var farValue = document.getElementById('far').value;
    var cityPlanProvinceEngValue = document.getElementById('cityPlanProvinceEng').value;

    // ตรวจสอบว่าทั้ง 4 ตัวแปรมีค่าว่างหรือไม่
    if (cityPlanEngValue === "" && yorEngValue === "" && farValue === "" && cityPlanProvinceEngValue === "") {
      convertCityPlanEng = ""; // ถ้าทั้ง 4 ตัวแปรเป็นค่าว่าง
    } else {
      convertCityPlanEng = ""; // ตั้งค่าเริ่มต้นเป็นว่าง

      // ตรวจสอบแต่ละตัวแปร
      if (cityPlanEngValue !== "") {
        convertCityPlanEng += cityPlanEngValue;
      }
      if (yorEngValue !== "") {
        if (convertCityPlanEng !== "") {
          convertCityPlanEng += ' ';
        }
        convertCityPlanEng += yorEngValue;
      }
      if (farValue !== "") {
        if (convertCityPlanEng !== "") {
          convertCityPlanEng += ' FAR ' + farValue + ' : 1 ';
        }
      }
      if (cityPlanProvinceEngValue !== "") {
        if (convertCityPlanEng !== "") {
          convertCityPlanEng += ' ' + cityPlanProvinceEngValue;
        }
      }
    }


    // เช็คค่าว่าง ผังเมืองอนาคต
    var futureCityPlanValue = document.getElementById('futureCityPlan').value;
    var yorfutureCityPlanValue = document.getElementById('yorfutureCityPlan').value;
    var faryorfutureCityPlanValue = document.getElementById('faryorfutureCityPlan').value;
    var cityPlanProvincefutureValue = document.getElementById('cityPlanProvincefuture').value;

    // ตรวจสอบว่าทั้ง 4 ตัวแปรมีค่าว่างหรือไม่
    if (futureCityPlanValue === "" && yorfutureCityPlanValue === "" && faryorfutureCityPlanValue === "" && cityPlanProvincefutureValue === "") {
      convertFutureCityPlan = ""; // ถ้าทั้ง 4 ตัวแปรเป็นค่าว่าง
    } else {
      convertFutureCityPlan = ""; // ตั้งค่าเริ่มต้นเป็นว่าง

      // ตรวจสอบแต่ละตัวแปร
      if (futureCityPlanValue !== "") {
        convertFutureCityPlan += futureCityPlanValue;
      }
      if (yorfutureCityPlanValue !== "") {
        if (convertFutureCityPlan !== "") {
          convertFutureCityPlan += ' ';
        }
        convertFutureCityPlan += yorfutureCityPlanValue;
      }
      if (faryorfutureCityPlanValue !== "") {
        if (convertFutureCityPlan !== "") {
          convertFutureCityPlan += ' FAR ' + faryorfutureCityPlanValue + ' : 1 ';
        }
      }
      if (cityPlanProvincefutureValue !== "") {
        if (convertFutureCityPlan !== "") {
          convertFutureCityPlan += ' ' + cityPlanProvincefutureValue;
        }
      }
    }

    // เช็คค่าว่างใน ผังเมืองอนาคต Eng
    var futureCityPlanEngValue = document.getElementById('futureCityPlanEng').value;
    var yorfutureCityPlanEngValue = document.getElementById('yorfutureCityPlanEng').value;
    var faryorfutureCityPlanValue = document.getElementById('faryorfutureCityPlan').value;
    var cityPlanProvincefutureEngValue = document.getElementById('cityPlanProvincefutureEng').value;

    // ตรวจสอบว่าทั้ง 4 ตัวแปรมีค่าว่างหรือไม่
    if (futureCityPlanEngValue === "" && yorfutureCityPlanEngValue === "" && faryorfutureCityPlanValue === "" && cityPlanProvincefutureEngValue === "") {
      convertFutureCityPlanEng = ""; // ถ้าทั้ง 4 ตัวแปรเป็นค่าว่าง
    } else {
      convertFutureCityPlanEng = ""; // ตั้งค่าเริ่มต้นเป็นว่าง

      // ตรวจสอบแต่ละตัวแปร
      if (futureCityPlanEngValue !== "") {
        convertFutureCityPlanEng += futureCityPlanEngValue;
      }
      if (yorfutureCityPlanEngValue !== "") {
        if (convertFutureCityPlanEng !== "") {
          convertFutureCityPlanEng += ' ';
        }
        convertFutureCityPlanEng += yorfutureCityPlanEngValue;
      }
      if (faryorfutureCityPlanValue !== "") {
        if (convertFutureCityPlanEng !== "") {
          convertFutureCityPlanEng += ' FAR ' + faryorfutureCityPlanValue + ' : 1 ';
        }
      }
      if (cityPlanProvincefutureEngValue !== "") {
        if (convertFutureCityPlanEng !== "") {
          convertFutureCityPlanEng += ' ' + cityPlanProvincefutureEngValue;
        }
      }
    }

    const formData = {
      OwnerId: document.getElementById('agent').value,
      CreatedById: document.getElementById('agent').value,
      RecordTypeId: document.getElementById('listing_type').value,
      pba__ListingType__c: document.getElementById('listing_type').options[document.getElementById('listing_type').selectedIndex].text,
      pba__PropertyType__c: document.getElementById('PropertyType').value,
      Name: document.getElementById('title').value,
      Title_Eng__c: document.getElementById('titleEng').value,
      pba__State_pb__c: document.getElementById('subdistrict').value,
      Subdistrict_Eng__c: document.getElementById('subdistrictEng').value,
      District__c: document.getElementById('district').value,
      District_Eng__c: document.getElementById('districtEng').value,
      pba__City_pb__c: document.getElementById('province').value,
      City_Eng__c: document.getElementById('provinceEng').value,
      pba__Latitude_pb__c: document.getElementById('latitude').value,
      pba__Longitude_pb__c: document.getElementById('longitude').value,
      rai__c: document.getElementById('rai').value,
      ngan__c: document.getElementById('ngan').value,
      Sq_Wah__c: document.getElementById('squareWah').value,
      pba__ListingPrice_pb__c: document.getElementById('price').value,
      cityplan__c: convertCityPlan,
      City_Plan_Eng__c: convertCityPlanEng,
      Provincial_town_plan__c: document.getElementById('cityPlanProvince').value,
      Future_city_plans__c: convertFutureCityPlan,
      New_City_Plan_Eng__c: convertFutureCityPlanEng,
      Wide__c: document.getElementById('width').value,
      Width_of_the_road_according_to_Rawang__c: document.getElementById('roadWidth').value,
      road_width__c: roadWidthConvert,
      road_width_Eng__c: roadWidthConvert,
      Description_thai__c: descriptionThaiContent,
      Description_Eng__c: descriptionEngContent,
      agreement__c: 'PRESENT ONLAND 459',
      start_date__c: new Date().toISOString(),
      level_of_information__c: document.getElementById('Level_of_reliability_of_information').value,
      appraisal_wah__c: document.getElementById('appraisalPrice').value,
      title_deed__c: document.getElementById('totaltitleDeed').value,
      length__c: document.getElementById('landDepth').value,
      nameroad__c: document.getElementById('roadName').value,
      Road_Name_Eng__c: document.getElementById('roadNameEng').value,
      status_road__c: document.getElementById('roadStatus').value,
      Road_Type_Eng__c: document.getElementById('roadStatusEng').value,
      soi__c: document.getElementById('soiName').value,
      Soi_Eng__c: document.getElementById('soiNameEng').value,
      tranfer__c: document.getElementById('tranfer').value,
      Price_Condition_Eng__c: document.getElementById('tranferEng').value,
      Land_condition__c: document.getElementById('Land_and_building_conditions').value,
      Land_Condition_Eng__c: document.getElementById('Land_and_building_conditionsEng').value,
      Tenant__c: document.getElementById('tenant').value,
      Tenant_Eng__c: document.getElementById('tenantEng').value,
    };
    console.log(formData);


    try {
      // Show loading spinner before making the request
      document.getElementById('loadingSpinner').style.display = 'inline-block';
      // Disable the button
      document.getElementById('sendToSalesforce').disabled = true;

      const response = await fetch('/sendToSalesforce', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formData),
      });

      const result = await response.json();
      console.log('Salesforce response:', result);

      // Update the HTML content based on the response
      const responseMessageDiv = document.getElementById('response-message');

      if (result.success) {
        // Check if the id property exists in recordData
        const idValue = result.recordData && result.recordData.id;

        if (idValue) {
          responseMessageDiv.innerHTML = `<p class="success-message">${result.message}</p>
                                <p>Record ID: ${idValue}</p>
                                <p>URL: <a href="https://realistestate.lightning.force.com/lightning/r/pba__Listing__c/${idValue}/view" target="_blank">Link</a></p>`;

        } else {
          responseMessageDiv.innerHTML = `<p class="success-message">${result.message}</p>
                                          <p>No Record ID found in the response data.</p>`;
        }
      } else {
        responseMessageDiv.innerHTML = `<p class="error-message">${result.message}</p>`;
      }

    } catch (error) {
      // Handle errors that may occur during the request
      console.error('Error during sending data to Salesforce:', error);
    } finally {
      // Hide loading spinner regardless of success or error
      document.getElementById('loadingSpinner').style.display = 'none';
      // Enable the button
      document.getElementById('sendToSalesforce').disabled = false;
    }

  }
});
  </script>
</body>

</html>